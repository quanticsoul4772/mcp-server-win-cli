
> @simonb97/server-win-cli@0.3.0 test
> node --experimental-vm-modules node_modules/jest/bin/jest.js

(node:37280) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
(node:36676) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
FAIL __tests__/security/error-sanitization.test.ts
  â— Error Message Sanitization and Path Disclosure Prevention â€º Unicode Attack Error Messages â€º should describe zero-width character attacks

    expect(received).toMatch(expected)

    Expected pattern: /zero-width/i
    Received string:  "Command contains blocked operator: '|'Â·
    WHY: Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.Â·
    TO FIX:
    1. Create a config file at one of these locations:
       - config.json (in current working directory)
       - ~/.win-cli-mcp/config.json (in home directory)
    2. Remove '|' from the \"shells.{shellName}.blockedOperators\" array
    3. Restart the MCP serverÂ·
    WARNING: Allowing '|' enables command chaining and could allow malicious code execution. Only allow if you trust all command sources.Â·
    TIP: Use the check_security_config tool to view all blocked operators for each shell."

    [0m [90m 361 |[39m
     [90m 362 |[39m         [90m// Should explain zero-width attack[39m
    [31m[1m>[22m[39m[90m 363 |[39m         expect(errorMsg)[33m.[39mtoMatch([35m/zero-width/i[39m)[33m;[39m
     [90m     |[39m                          [31m[1m^[22m[39m
     [90m 364 |[39m         expect(errorMsg)[33m.[39mtoMatch([35m/invisible/i[39m)[33m;[39m
     [90m 365 |[39m
     [90m 366 |[39m         [90m// Should provide guidance[39m[0m

      at Object.<anonymous> (__tests__/security/error-sanitization.test.ts:363:26)

(node:35788) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
PASS tests/validation.test.ts
(node:20512) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
FAIL __tests__/security/path-traversal.test.ts
  â— Console

    console.warn
      Skipping symlink test: requires admin privileges on Windows

    [0m [90m 149 |[39m       } [36mcatch[39m (error) {
     [90m 150 |[39m         [36mif[39m ((error [36mas[39m [33mNodeJS[39m[33m.[39m[33mErrnoException[39m)[33m.[39mcode [33m===[39m [32m'EPERM'[39m) {
    [31m[1m>[22m[39m[90m 151 |[39m           console[33m.[39mwarn([32m'Skipping symlink test: requires admin privileges on Windows'[39m)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 152 |[39m           [36mreturn[39m[33m;[39m [90m// Skip this test if we don't have permission to create symlinks[39m
     [90m 153 |[39m         }
     [90m 154 |[39m         [36mthrow[39m error[33m;[39m[0m

      at Object.<anonymous> (__tests__/security/path-traversal.test.ts:151:19)

    console.warn
      Skipping symlink test: requires admin privileges on Windows

    [0m [90m 173 |[39m       } [36mcatch[39m (error) {
     [90m 174 |[39m         [36mif[39m ((error [36mas[39m [33mNodeJS[39m[33m.[39m[33mErrnoException[39m)[33m.[39mcode [33m===[39m [32m'EPERM'[39m) {
    [31m[1m>[22m[39m[90m 175 |[39m           console[33m.[39mwarn([32m'Skipping symlink test: requires admin privileges on Windows'[39m)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 176 |[39m           [36mreturn[39m[33m;[39m
     [90m 177 |[39m         }
     [90m 178 |[39m         [36mthrow[39m error[33m;[39m[0m

      at Object.<anonymous> (__tests__/security/path-traversal.test.ts:175:19)

    console.warn
      Skipping broken symlink test: requires admin privileges on Windows

    [0m [90m 192 |[39m       } [36mcatch[39m (error) {
     [90m 193 |[39m         [36mif[39m ((error [36mas[39m [33mNodeJS[39m[33m.[39m[33mErrnoException[39m)[33m.[39mcode [33m===[39m [32m'EPERM'[39m) {
    [31m[1m>[22m[39m[90m 194 |[39m           console[33m.[39mwarn([32m'Skipping broken symlink test: requires admin privileges on Windows'[39m)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 195 |[39m           [36mreturn[39m[33m;[39m
     [90m 196 |[39m         }
     [90m 197 |[39m         [36mthrow[39m error[33m;[39m[0m

      at Object.<anonymous> (__tests__/security/path-traversal.test.ts:194:19)

    console.warn
      Skipping TOCTOU test: requires admin privileges on Windows

    [0m [90m 426 |[39m       } [36mcatch[39m (error) {
     [90m 427 |[39m         [36mif[39m ((error [36mas[39m [33mNodeJS[39m[33m.[39m[33mErrnoException[39m)[33m.[39mcode [33m===[39m [32m'EPERM'[39m) {
    [31m[1m>[22m[39m[90m 428 |[39m           console[33m.[39mwarn([32m'Skipping TOCTOU test: requires admin privileges on Windows'[39m)[33m;[39m
     [90m     |[39m                   [31m[1m^[22m[39m
     [90m 429 |[39m           [36mreturn[39m[33m;[39m
     [90m 430 |[39m         }
     [90m 431 |[39m         [36mthrow[39m error[33m;[39m[0m

      at Object.<anonymous> (__tests__/security/path-traversal.test.ts:428:19)

  â— Path Traversal Attack Vectors â€º Windows-Specific Path Tricks â€º should handle UNC paths

    expect(received).toBe(expected) // Object.is equality

    Expected: "\\\\server\\share\\file.txt"
    Received: "C:\\server\\share\\file.txt"

    [0m [90m 204 |[39m       [36mconst[39m uncPath [33m=[39m [32m'\\\\server\\share\\file.txt'[39m[33m;[39m
     [90m 205 |[39m       [36mconst[39m normalized [33m=[39m normalizeWindowsPath(uncPath)[33m;[39m
    [31m[1m>[22m[39m[90m 206 |[39m       expect(normalized)[33m.[39mtoBe([32m'\\\\server\\share\\file.txt'[39m)[33m;[39m
     [90m     |[39m                          [31m[1m^[22m[39m
     [90m 207 |[39m     })[33m;[39m
     [90m 208 |[39m
     [90m 209 |[39m     test([32m'should block UNC paths if not in allowed list'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (__tests__/security/path-traversal.test.ts:206:26)

(node:18544) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
(node:37756) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
FAIL __tests__/security/unicode-attacks.test.ts
  â— Unicode Attack Vectors â€º Zero-Width Character Attacks â€º should block zero-width space (U+200B)

    expect(received).toThrow(expected)

    Expected pattern: /zero-width characters/i
    Received message: "Command contains blocked operator: '|'Â·
    WHY: Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.Â·
    TO FIX:
    1. Create a config file at one of these locations:
       - config.json (in current working directory)
       - ~/.win-cli-mcp/config.json (in home directory)
    2. Remove '|' from the \"shells.{shellName}.blockedOperators\" array
    3. Restart the MCP serverÂ·
    WARNING: Allowing '|' enables command chaining and could allow malicious code execution. Only allow if you trust all command sources.Â·
    TIP: Use the check_security_config tool to view all blocked operators for each shell."

        [0m [90m 376 |[39m         [36mif[39m (normalizedCommand[33m.[39mincludes(op)) {
         [90m 377 |[39m             [36mconst[39m configLocationMsg [33m=[39m getConfigLocationMessage(configPath)[33m;[39m
        [31m[1m>[22m[39m[90m 378 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m                   [31m[1m^[22m[39m
         [90m 379 |[39m                 what[33m:[39m [32m`Command contains blocked operator: '${op}'`[39m[33m,[39m
         [90m 380 |[39m                 why[33m:[39m [32m'Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.'[39m[33m,[39m
         [90m 381 |[39m                 howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:378:19)
      at __tests__/security/unicode-attacks.test.ts:148:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:149:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:149:10)

  â— Unicode Attack Vectors â€º Zero-Width Character Attacks â€º should block zero-width non-joiner (U+200C)

    expect(received).toThrow(expected)

    Expected pattern: /zero-width characters/i
    Received message: "Command contains blocked operator: '&'Â·
    WHY: Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.Â·
    TO FIX:
    1. Create a config file at one of these locations:
       - config.json (in current working directory)
       - ~/.win-cli-mcp/config.json (in home directory)
    2. Remove '&' from the \"shells.{shellName}.blockedOperators\" array
    3. Restart the MCP serverÂ·
    WARNING: Allowing '&' enables command chaining and could allow malicious code execution. Only allow if you trust all command sources.Â·
    TIP: Use the check_security_config tool to view all blocked operators for each shell."

        [0m [90m 376 |[39m         [36mif[39m (normalizedCommand[33m.[39mincludes(op)) {
         [90m 377 |[39m             [36mconst[39m configLocationMsg [33m=[39m getConfigLocationMessage(configPath)[33m;[39m
        [31m[1m>[22m[39m[90m 378 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m                   [31m[1m^[22m[39m
         [90m 379 |[39m                 what[33m:[39m [32m`Command contains blocked operator: '${op}'`[39m[33m,[39m
         [90m 380 |[39m                 why[33m:[39m [32m'Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.'[39m[33m,[39m
         [90m 381 |[39m                 howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:378:19)
      at __tests__/security/unicode-attacks.test.ts:154:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:155:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:155:10)

  â— Unicode Attack Vectors â€º Zero-Width Character Attacks â€º should block zero-width joiner (U+200D)

    expect(received).toThrow(expected)

    Expected pattern: /zero-width characters/i
    Received message: "Command contains blocked operator: ';'Â·
    WHY: Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.Â·
    TO FIX:
    1. Create a config file at one of these locations:
       - config.json (in current working directory)
       - ~/.win-cli-mcp/config.json (in home directory)
    2. Remove ';' from the \"shells.{shellName}.blockedOperators\" array
    3. Restart the MCP serverÂ·
    WARNING: Allowing ';' enables command chaining and could allow malicious code execution. Only allow if you trust all command sources.Â·
    TIP: Use the check_security_config tool to view all blocked operators for each shell."

        [0m [90m 376 |[39m         [36mif[39m (normalizedCommand[33m.[39mincludes(op)) {
         [90m 377 |[39m             [36mconst[39m configLocationMsg [33m=[39m getConfigLocationMessage(configPath)[33m;[39m
        [31m[1m>[22m[39m[90m 378 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m                   [31m[1m^[22m[39m
         [90m 379 |[39m                 what[33m:[39m [32m`Command contains blocked operator: '${op}'`[39m[33m,[39m
         [90m 380 |[39m                 why[33m:[39m [32m'Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.'[39m[33m,[39m
         [90m 381 |[39m                 howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:378:19)
      at __tests__/security/unicode-attacks.test.ts:160:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:161:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:161:10)

  â— Unicode Attack Vectors â€º Zero-Width Character Attacks â€º should block zero-width no-break space / BOM (U+FEFF)

    expect(received).toThrow(expected)

    Expected pattern: /zero-width characters/i
    Received message: "Command contains blocked operator: '|'Â·
    WHY: Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.Â·
    TO FIX:
    1. Create a config file at one of these locations:
       - config.json (in current working directory)
       - ~/.win-cli-mcp/config.json (in home directory)
    2. Remove '|' from the \"shells.{shellName}.blockedOperators\" array
    3. Restart the MCP serverÂ·
    WARNING: Allowing '|' enables command chaining and could allow malicious code execution. Only allow if you trust all command sources.Â·
    TIP: Use the check_security_config tool to view all blocked operators for each shell."

        [0m [90m 376 |[39m         [36mif[39m (normalizedCommand[33m.[39mincludes(op)) {
         [90m 377 |[39m             [36mconst[39m configLocationMsg [33m=[39m getConfigLocationMessage(configPath)[33m;[39m
        [31m[1m>[22m[39m[90m 378 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m                   [31m[1m^[22m[39m
         [90m 379 |[39m                 what[33m:[39m [32m`Command contains blocked operator: '${op}'`[39m[33m,[39m
         [90m 380 |[39m                 why[33m:[39m [32m'Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.'[39m[33m,[39m
         [90m 381 |[39m                 howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:378:19)
      at __tests__/security/unicode-attacks.test.ts:166:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:167:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:167:10)

  â— Unicode Attack Vectors â€º Zero-Width Character Attacks â€º should block zero-width characters used to split operators

    expect(received).toThrow(expected)

    Expected pattern: /zero-width characters/i
    Received message: "Command contains blocked operator: '&'Â·
    WHY: Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.Â·
    TO FIX:
    1. Create a config file at one of these locations:
       - config.json (in current working directory)
       - ~/.win-cli-mcp/config.json (in home directory)
    2. Remove '&' from the \"shells.{shellName}.blockedOperators\" array
    3. Restart the MCP serverÂ·
    WARNING: Allowing '&' enables command chaining and could allow malicious code execution. Only allow if you trust all command sources.Â·
    TIP: Use the check_security_config tool to view all blocked operators for each shell."

        [0m [90m 376 |[39m         [36mif[39m (normalizedCommand[33m.[39mincludes(op)) {
         [90m 377 |[39m             [36mconst[39m configLocationMsg [33m=[39m getConfigLocationMessage(configPath)[33m;[39m
        [31m[1m>[22m[39m[90m 378 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m                   [31m[1m^[22m[39m
         [90m 379 |[39m                 what[33m:[39m [32m`Command contains blocked operator: '${op}'`[39m[33m,[39m
         [90m 380 |[39m                 why[33m:[39m [32m'Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.'[39m[33m,[39m
         [90m 381 |[39m                 howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:378:19)
      at __tests__/security/unicode-attacks.test.ts:173:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:174:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:174:10)

  â— Unicode Attack Vectors â€º Zero-Width Character Attacks â€º should block multiple zero-width characters in sequence

    expect(received).toThrow(expected)

    Expected pattern: /zero-width characters/i
    Received message: "Command contains blocked operator: '|'Â·
    WHY: Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.Â·
    TO FIX:
    1. Create a config file at one of these locations:
       - config.json (in current working directory)
       - ~/.win-cli-mcp/config.json (in home directory)
    2. Remove '|' from the \"shells.{shellName}.blockedOperators\" array
    3. Restart the MCP serverÂ·
    WARNING: Allowing '|' enables command chaining and could allow malicious code execution. Only allow if you trust all command sources.Â·
    TIP: Use the check_security_config tool to view all blocked operators for each shell."

        [0m [90m 376 |[39m         [36mif[39m (normalizedCommand[33m.[39mincludes(op)) {
         [90m 377 |[39m             [36mconst[39m configLocationMsg [33m=[39m getConfigLocationMessage(configPath)[33m;[39m
        [31m[1m>[22m[39m[90m 378 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m                   [31m[1m^[22m[39m
         [90m 379 |[39m                 what[33m:[39m [32m`Command contains blocked operator: '${op}'`[39m[33m,[39m
         [90m 380 |[39m                 why[33m:[39m [32m'Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.'[39m[33m,[39m
         [90m 381 |[39m                 howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:378:19)
      at __tests__/security/unicode-attacks.test.ts:179:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:180:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:180:10)

  â— Unicode Attack Vectors â€º Bidirectional Text Override (BiDi) Attacks â€º should block Right-to-Left Override (U+202E)

    expect(received).toThrow(expected)

    Expected pattern: /dangerous control characters/i
    Received message: "Command contains Bidirectional (BiDi) control character: U+202E (RIGHT-TO-LEFT OVERRIDE - RLO)Â·
    WHY: BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the \"Trojan Source\" attack (CVE-2021-42574).Â·
    TO FIX:
    1. Remove the BiDi control character from your command
    2. Retype the command manually from a trusted source
    3. Inspect the command using a hex editor to identify hidden control charactersÂ·
    WARNING: BiDi text attacks can make malicious code appear legitimate in logs and source code. This protection cannot be disabled.Â·
    TIP: Reference: CVE-2021-42574 - Trojan Source vulnerability"

        [0m [90m 293 |[39m     [36mconst[39m bidiCheck [33m=[39m detectBidiControlCharacters(normalizedCommand)[33m;[39m
         [90m 294 |[39m     [36mif[39m (bidiCheck[33m.[39mdetected) {
        [31m[1m>[22m[39m[90m 295 |[39m         [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m               [31m[1m^[22m[39m
         [90m 296 |[39m             what[33m:[39m [32m`Command contains Bidirectional (BiDi) control character: ${bidiCheck.codepoint}`[39m[33m,[39m
         [90m 297 |[39m             why[33m:[39m [32m'BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the "Trojan Source" attack (CVE-2021-42574).'[39m[33m,[39m
         [90m 298 |[39m             howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:295:15)
      at __tests__/security/unicode-attacks.test.ts:188:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:189:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:189:10)

  â— Unicode Attack Vectors â€º Bidirectional Text Override (BiDi) Attacks â€º should block Left-to-Right Override (U+202D)

    expect(received).toThrow(expected)

    Expected pattern: /dangerous control characters/i
    Received message: "Command contains Bidirectional (BiDi) control character: U+202D (LEFT-TO-RIGHT OVERRIDE - LRO)Â·
    WHY: BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the \"Trojan Source\" attack (CVE-2021-42574).Â·
    TO FIX:
    1. Remove the BiDi control character from your command
    2. Retype the command manually from a trusted source
    3. Inspect the command using a hex editor to identify hidden control charactersÂ·
    WARNING: BiDi text attacks can make malicious code appear legitimate in logs and source code. This protection cannot be disabled.Â·
    TIP: Reference: CVE-2021-42574 - Trojan Source vulnerability"

        [0m [90m 293 |[39m     [36mconst[39m bidiCheck [33m=[39m detectBidiControlCharacters(normalizedCommand)[33m;[39m
         [90m 294 |[39m     [36mif[39m (bidiCheck[33m.[39mdetected) {
        [31m[1m>[22m[39m[90m 295 |[39m         [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m               [31m[1m^[22m[39m
         [90m 296 |[39m             what[33m:[39m [32m`Command contains Bidirectional (BiDi) control character: ${bidiCheck.codepoint}`[39m[33m,[39m
         [90m 297 |[39m             why[33m:[39m [32m'BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the "Trojan Source" attack (CVE-2021-42574).'[39m[33m,[39m
         [90m 298 |[39m             howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:295:15)
      at __tests__/security/unicode-attacks.test.ts:194:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:195:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:195:10)

  â— Unicode Attack Vectors â€º Bidirectional Text Override (BiDi) Attacks â€º should block Right-to-Left Embedding (U+202B)

    expect(received).toThrow(expected)

    Expected pattern: /dangerous control characters/i
    Received message: "Command contains Bidirectional (BiDi) control character: U+202B (RIGHT-TO-LEFT EMBEDDING - RLE)Â·
    WHY: BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the \"Trojan Source\" attack (CVE-2021-42574).Â·
    TO FIX:
    1. Remove the BiDi control character from your command
    2. Retype the command manually from a trusted source
    3. Inspect the command using a hex editor to identify hidden control charactersÂ·
    WARNING: BiDi text attacks can make malicious code appear legitimate in logs and source code. This protection cannot be disabled.Â·
    TIP: Reference: CVE-2021-42574 - Trojan Source vulnerability"

        [0m [90m 293 |[39m     [36mconst[39m bidiCheck [33m=[39m detectBidiControlCharacters(normalizedCommand)[33m;[39m
         [90m 294 |[39m     [36mif[39m (bidiCheck[33m.[39mdetected) {
        [31m[1m>[22m[39m[90m 295 |[39m         [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m               [31m[1m^[22m[39m
         [90m 296 |[39m             what[33m:[39m [32m`Command contains Bidirectional (BiDi) control character: ${bidiCheck.codepoint}`[39m[33m,[39m
         [90m 297 |[39m             why[33m:[39m [32m'BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the "Trojan Source" attack (CVE-2021-42574).'[39m[33m,[39m
         [90m 298 |[39m             howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:295:15)
      at __tests__/security/unicode-attacks.test.ts:200:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:201:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:201:10)

  â— Unicode Attack Vectors â€º Bidirectional Text Override (BiDi) Attacks â€º should block Left-to-Right Embedding (U+202A)

    expect(received).toThrow(expected)

    Expected pattern: /dangerous control characters/i
    Received message: "Command contains Bidirectional (BiDi) control character: U+202A (LEFT-TO-RIGHT EMBEDDING - LRE)Â·
    WHY: BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the \"Trojan Source\" attack (CVE-2021-42574).Â·
    TO FIX:
    1. Remove the BiDi control character from your command
    2. Retype the command manually from a trusted source
    3. Inspect the command using a hex editor to identify hidden control charactersÂ·
    WARNING: BiDi text attacks can make malicious code appear legitimate in logs and source code. This protection cannot be disabled.Â·
    TIP: Reference: CVE-2021-42574 - Trojan Source vulnerability"

        [0m [90m 293 |[39m     [36mconst[39m bidiCheck [33m=[39m detectBidiControlCharacters(normalizedCommand)[33m;[39m
         [90m 294 |[39m     [36mif[39m (bidiCheck[33m.[39mdetected) {
        [31m[1m>[22m[39m[90m 295 |[39m         [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m               [31m[1m^[22m[39m
         [90m 296 |[39m             what[33m:[39m [32m`Command contains Bidirectional (BiDi) control character: ${bidiCheck.codepoint}`[39m[33m,[39m
         [90m 297 |[39m             why[33m:[39m [32m'BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the "Trojan Source" attack (CVE-2021-42574).'[39m[33m,[39m
         [90m 298 |[39m             howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:295:15)
      at __tests__/security/unicode-attacks.test.ts:206:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:207:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:207:10)

  â— Unicode Attack Vectors â€º Bidirectional Text Override (BiDi) Attacks â€º should block Pop Directional Formatting (U+202C)

    expect(received).toThrow(expected)

    Expected pattern: /dangerous control characters/i
    Received message: "Command contains Bidirectional (BiDi) control character: U+202C (POP DIRECTIONAL FORMATTING - PDF)Â·
    WHY: BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the \"Trojan Source\" attack (CVE-2021-42574).Â·
    TO FIX:
    1. Remove the BiDi control character from your command
    2. Retype the command manually from a trusted source
    3. Inspect the command using a hex editor to identify hidden control charactersÂ·
    WARNING: BiDi text attacks can make malicious code appear legitimate in logs and source code. This protection cannot be disabled.Â·
    TIP: Reference: CVE-2021-42574 - Trojan Source vulnerability"

        [0m [90m 293 |[39m     [36mconst[39m bidiCheck [33m=[39m detectBidiControlCharacters(normalizedCommand)[33m;[39m
         [90m 294 |[39m     [36mif[39m (bidiCheck[33m.[39mdetected) {
        [31m[1m>[22m[39m[90m 295 |[39m         [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m               [31m[1m^[22m[39m
         [90m 296 |[39m             what[33m:[39m [32m`Command contains Bidirectional (BiDi) control character: ${bidiCheck.codepoint}`[39m[33m,[39m
         [90m 297 |[39m             why[33m:[39m [32m'BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the "Trojan Source" attack (CVE-2021-42574).'[39m[33m,[39m
         [90m 298 |[39m             howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:295:15)
      at __tests__/security/unicode-attacks.test.ts:212:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:213:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:213:10)

  â— Unicode Attack Vectors â€º PowerShell Smart Quote Attacks â€º should block right double quotation mark (U+201D) - PowerShell smart quote

    expect(received).toThrow(expected)

    Expected pattern: /dangerous control characters/i
    Received message: "Command contains PowerShell Unicode quote: U+201D (RIGHT DOUBLE QUOTATION MARK)Â·
    WHY: PowerShell interprets Unicode quotation marks (U+201C, U+201D, U+2018, U+2019) as string delimiters, allowing command injection attacks. These \"smart quotes\" are often inserted by word processors.Â·
    TO FIX:
    1. Replace the Unicode quote character 'â€' with a standard ASCII quote (\") or (')
    2. Retype the command manually instead of copying from Word, email, or web pages
    3. Use a plain text editor that doesn't auto-convert quotesÂ·
    WARNING: PowerShell Unicode quote injection is a documented security vulnerability. This protection cannot be disabled.Â·
    TIP: Reference: https://blog.stmcyber.com/powershell-unicode-quotes-and-command-injection/"

        [0m [90m 276 |[39m     [36mconst[39m unicodeQuoteCheck [33m=[39m detectPowerShellUnicodeQuotes(normalizedCommand)[33m;[39m
         [90m 277 |[39m     [36mif[39m (unicodeQuoteCheck[33m.[39mdetected) {
        [31m[1m>[22m[39m[90m 278 |[39m         [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m               [31m[1m^[22m[39m
         [90m 279 |[39m             what[33m:[39m [32m`Command contains PowerShell Unicode quote: ${unicodeQuoteCheck.codepoint}`[39m[33m,[39m
         [90m 280 |[39m             why[33m:[39m [32m'PowerShell interprets Unicode quotation marks (U+201C, U+201D, U+2018, U+2019) as string delimiters, allowing command injection attacks. These "smart quotes" are often inserted by word processors.'[39m[33m,[39m
         [90m 281 |[39m             howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:278:15)
      at __tests__/security/unicode-attacks.test.ts:222:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:223:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:223:10)

  â— Unicode Attack Vectors â€º PowerShell Smart Quote Attacks â€º should block left double quotation mark (U+201C)

    expect(received).toThrow(expected)

    Expected pattern: /dangerous control characters/i
    Received message: "Command contains PowerShell Unicode quote: U+201C (LEFT DOUBLE QUOTATION MARK)Â·
    WHY: PowerShell interprets Unicode quotation marks (U+201C, U+201D, U+2018, U+2019) as string delimiters, allowing command injection attacks. These \"smart quotes\" are often inserted by word processors.Â·
    TO FIX:
    1. Replace the Unicode quote character 'â€œ' with a standard ASCII quote (\") or (')
    2. Retype the command manually instead of copying from Word, email, or web pages
    3. Use a plain text editor that doesn't auto-convert quotesÂ·
    WARNING: PowerShell Unicode quote injection is a documented security vulnerability. This protection cannot be disabled.Â·
    TIP: Reference: https://blog.stmcyber.com/powershell-unicode-quotes-and-command-injection/"

        [0m [90m 276 |[39m     [36mconst[39m unicodeQuoteCheck [33m=[39m detectPowerShellUnicodeQuotes(normalizedCommand)[33m;[39m
         [90m 277 |[39m     [36mif[39m (unicodeQuoteCheck[33m.[39mdetected) {
        [31m[1m>[22m[39m[90m 278 |[39m         [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m               [31m[1m^[22m[39m
         [90m 279 |[39m             what[33m:[39m [32m`Command contains PowerShell Unicode quote: ${unicodeQuoteCheck.codepoint}`[39m[33m,[39m
         [90m 280 |[39m             why[33m:[39m [32m'PowerShell interprets Unicode quotation marks (U+201C, U+201D, U+2018, U+2019) as string delimiters, allowing command injection attacks. These "smart quotes" are often inserted by word processors.'[39m[33m,[39m
         [90m 281 |[39m             howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:278:15)
      at __tests__/security/unicode-attacks.test.ts:228:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:229:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:229:10)

  â— Unicode Attack Vectors â€º PowerShell Smart Quote Attacks â€º should block right single quotation mark (U+2019)

    expect(received).toThrow(expected)

    Expected pattern: /dangerous control characters/i
    Received message: "Command contains PowerShell Unicode quote: U+2019 (RIGHT SINGLE QUOTATION MARK)Â·
    WHY: PowerShell interprets Unicode quotation marks (U+201C, U+201D, U+2018, U+2019) as string delimiters, allowing command injection attacks. These \"smart quotes\" are often inserted by word processors.Â·
    TO FIX:
    1. Replace the Unicode quote character 'â€™' with a standard ASCII quote (\") or (')
    2. Retype the command manually instead of copying from Word, email, or web pages
    3. Use a plain text editor that doesn't auto-convert quotesÂ·
    WARNING: PowerShell Unicode quote injection is a documented security vulnerability. This protection cannot be disabled.Â·
    TIP: Reference: https://blog.stmcyber.com/powershell-unicode-quotes-and-command-injection/"

        [0m [90m 276 |[39m     [36mconst[39m unicodeQuoteCheck [33m=[39m detectPowerShellUnicodeQuotes(normalizedCommand)[33m;[39m
         [90m 277 |[39m     [36mif[39m (unicodeQuoteCheck[33m.[39mdetected) {
        [31m[1m>[22m[39m[90m 278 |[39m         [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m               [31m[1m^[22m[39m
         [90m 279 |[39m             what[33m:[39m [32m`Command contains PowerShell Unicode quote: ${unicodeQuoteCheck.codepoint}`[39m[33m,[39m
         [90m 280 |[39m             why[33m:[39m [32m'PowerShell interprets Unicode quotation marks (U+201C, U+201D, U+2018, U+2019) as string delimiters, allowing command injection attacks. These "smart quotes" are often inserted by word processors.'[39m[33m,[39m
         [90m 281 |[39m             howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:278:15)
      at __tests__/security/unicode-attacks.test.ts:234:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:235:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:235:10)

  â— Unicode Attack Vectors â€º PowerShell Smart Quote Attacks â€º should block left single quotation mark (U+2018)

    expect(received).toThrow(expected)

    Expected pattern: /dangerous control characters/i
    Received message: "Command contains PowerShell Unicode quote: U+2018 (LEFT SINGLE QUOTATION MARK)Â·
    WHY: PowerShell interprets Unicode quotation marks (U+201C, U+201D, U+2018, U+2019) as string delimiters, allowing command injection attacks. These \"smart quotes\" are often inserted by word processors.Â·
    TO FIX:
    1. Replace the Unicode quote character 'â€˜' with a standard ASCII quote (\") or (')
    2. Retype the command manually instead of copying from Word, email, or web pages
    3. Use a plain text editor that doesn't auto-convert quotesÂ·
    WARNING: PowerShell Unicode quote injection is a documented security vulnerability. This protection cannot be disabled.Â·
    TIP: Reference: https://blog.stmcyber.com/powershell-unicode-quotes-and-command-injection/"

        [0m [90m 276 |[39m     [36mconst[39m unicodeQuoteCheck [33m=[39m detectPowerShellUnicodeQuotes(normalizedCommand)[33m;[39m
         [90m 277 |[39m     [36mif[39m (unicodeQuoteCheck[33m.[39mdetected) {
        [31m[1m>[22m[39m[90m 278 |[39m         [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m               [31m[1m^[22m[39m
         [90m 279 |[39m             what[33m:[39m [32m`Command contains PowerShell Unicode quote: ${unicodeQuoteCheck.codepoint}`[39m[33m,[39m
         [90m 280 |[39m             why[33m:[39m [32m'PowerShell interprets Unicode quotation marks (U+201C, U+201D, U+2018, U+2019) as string delimiters, allowing command injection attacks. These "smart quotes" are often inserted by word processors.'[39m[33m,[39m
         [90m 281 |[39m             howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:278:15)
      at __tests__/security/unicode-attacks.test.ts:240:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:241:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:241:10)

  â— Unicode Attack Vectors â€º Control Character Injection â€º should block carriage return (U+000D) when not followed by newline

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

    [0m [90m 312 |[39m     test([32m'should block carriage return (U+000D) when not followed by newline'[39m[33m,[39m () [33m=>[39m {
     [90m 313 |[39m       [36mconst[39m maliciousCommand [33m=[39m [32m'echo\rtest'[39m[33m;[39m
    [31m[1m>[22m[39m[90m 314 |[39m       expect(containsDangerousCharacters(maliciousCommand))[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m     |[39m                                                             [31m[1m^[22m[39m
     [90m 315 |[39m     })[33m;[39m
     [90m 316 |[39m
     [90m 317 |[39m     test([32m'should block escape (U+001B)'[39m[33m,[39m () [33m=>[39m {[0m

      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:314:61)

  â— Unicode Attack Vectors â€º Combined Attack Vectors â€º should block homoglyph + zero-width character combination

    expect(received).toThrow(expected)

    Expected pattern: /zero-width characters/i
    Received message: "Command contains Unicode variant of blocked operator: '|' (detected: 'ï½œ')Â·
    WHY: Attackers use Unicode lookalike characters (homoglyphs) to bypass security filters. These characters appear like normal operators but use different Unicode codepoints.Â·
    TO FIX:
    1. Replace the Unicode character 'ï½œ' with the standard ASCII operator '|'
    2. If this is a legitimate use case (e.g., displaying Unicode in output), consider using escape sequences or a different approach
    3. Retype the command manually instead of copying from untrusted sourcesÂ·
    WARNING: Unicode homoglyph attacks are a known security vector. This protection cannot be disabled.Â·
    TIP: If you copied this command from a document or web page, Unicode characters may have been substituted."

        [0m [90m 425 |[39m         [36mfor[39m ([36mconst[39m variant [36mof[39m variants) {
         [90m 426 |[39m             [36mif[39m (normalizedCommand[33m.[39mincludes(variant)) {
        [31m[1m>[22m[39m[90m 427 |[39m                 [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m                       [31m[1m^[22m[39m
         [90m 428 |[39m                     what[33m:[39m [32m`Command contains Unicode variant of blocked operator: '${ascii}' (detected: '${variant}')`[39m[33m,[39m
         [90m 429 |[39m                     why[33m:[39m [32m'Attackers use Unicode lookalike characters (homoglyphs) to bypass security filters. These characters appear like normal operators but use different Unicode codepoints.'[39m[33m,[39m
         [90m 430 |[39m                     howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:427:23)
      at __tests__/security/unicode-attacks.test.ts:332:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:333:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:333:10)

  â— Unicode Attack Vectors â€º Combined Attack Vectors â€º should block BiDi + operator combination

    expect(received).toThrow(expected)

    Expected pattern: /dangerous control characters/i
    Received message: "Command contains Bidirectional (BiDi) control character: U+202E (RIGHT-TO-LEFT OVERRIDE - RLO)Â·
    WHY: BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the \"Trojan Source\" attack (CVE-2021-42574).Â·
    TO FIX:
    1. Remove the BiDi control character from your command
    2. Retype the command manually from a trusted source
    3. Inspect the command using a hex editor to identify hidden control charactersÂ·
    WARNING: BiDi text attacks can make malicious code appear legitimate in logs and source code. This protection cannot be disabled.Â·
    TIP: Reference: CVE-2021-42574 - Trojan Source vulnerability"

        [0m [90m 293 |[39m     [36mconst[39m bidiCheck [33m=[39m detectBidiControlCharacters(normalizedCommand)[33m;[39m
         [90m 294 |[39m     [36mif[39m (bidiCheck[33m.[39mdetected) {
        [31m[1m>[22m[39m[90m 295 |[39m         [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m               [31m[1m^[22m[39m
         [90m 296 |[39m             what[33m:[39m [32m`Command contains Bidirectional (BiDi) control character: ${bidiCheck.codepoint}`[39m[33m,[39m
         [90m 297 |[39m             why[33m:[39m [32m'BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the "Trojan Source" attack (CVE-2021-42574).'[39m[33m,[39m
         [90m 298 |[39m             howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:295:15)
      at __tests__/security/unicode-attacks.test.ts:338:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:339:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:339:10)

  â— Unicode Attack Vectors â€º Combined Attack Vectors â€º should block multiple different Unicode attacks in single command

    expect(received).toThrow(expected)

    Expected pattern: /zero-width characters|Unicode variant|dangerous control characters/i
    Received message: "Command contains Bidirectional (BiDi) control character: U+202E (RIGHT-TO-LEFT OVERRIDE - RLO)Â·
    WHY: BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the \"Trojan Source\" attack (CVE-2021-42574).Â·
    TO FIX:
    1. Remove the BiDi control character from your command
    2. Retype the command manually from a trusted source
    3. Inspect the command using a hex editor to identify hidden control charactersÂ·
    WARNING: BiDi text attacks can make malicious code appear legitimate in logs and source code. This protection cannot be disabled.Â·
    TIP: Reference: CVE-2021-42574 - Trojan Source vulnerability"

        [0m [90m 293 |[39m     [36mconst[39m bidiCheck [33m=[39m detectBidiControlCharacters(normalizedCommand)[33m;[39m
         [90m 294 |[39m     [36mif[39m (bidiCheck[33m.[39mdetected) {
        [31m[1m>[22m[39m[90m 295 |[39m         [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m               [31m[1m^[22m[39m
         [90m 296 |[39m             what[33m:[39m [32m`Command contains Bidirectional (BiDi) control character: ${bidiCheck.codepoint}`[39m[33m,[39m
         [90m 297 |[39m             why[33m:[39m [32m'BiDi override characters (U+202E, U+202D, etc.) can hide malicious code by reversing the display order of text. This is known as the "Trojan Source" attack (CVE-2021-42574).'[39m[33m,[39m
         [90m 298 |[39m             howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:295:15)
      at __tests__/security/unicode-attacks.test.ts:344:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:345:10)
      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:345:10)

  â— Unicode Attack Vectors â€º Edge Cases and Regression Tests â€º should provide helpful error messages for zero-width characters

    expect(received).toMatch(expected)

    Expected pattern: /zero-width/i
    Received string:  "Command contains blocked operator: '|'Â·
    WHY: Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.Â·
    TO FIX:
    1. Create a config file at one of these locations:
       - config.json (in current working directory)
       - ~/.win-cli-mcp/config.json (in home directory)
    2. Remove '|' from the \"shells.{shellName}.blockedOperators\" array
    3. Restart the MCP serverÂ·
    WARNING: Allowing '|' enables command chaining and could allow malicious code execution. Only allow if you trust all command sources.Â·
    TIP: Use the check_security_config tool to view all blocked operators for each shell."

    [0m [90m 398 |[39m       } [36mcatch[39m (error) {
     [90m 399 |[39m         [36mconst[39m errorMsg [33m=[39m error [36minstanceof[39m [33mError[39m [33m?[39m error[33m.[39mmessage [33m:[39m [33mString[39m(error)[33m;[39m
    [31m[1m>[22m[39m[90m 400 |[39m         expect(errorMsg)[33m.[39mtoMatch([35m/zero-width/i[39m)[33m;[39m
     [90m     |[39m                          [31m[1m^[22m[39m
     [90m 401 |[39m         expect(errorMsg)[33m.[39mtoMatch([35m/invisible/i[39m)[33m;[39m
     [90m 402 |[39m         expect(errorMsg)[33m.[39mtoMatch([35m/bypass/i[39m)[33m;[39m
     [90m 403 |[39m       }[0m

      at Object.<anonymous> (__tests__/security/unicode-attacks.test.ts:400:26)

FAIL __tests__/security/command-injection.test.ts
  â— Command Injection Attack Vectors â€º Shell Operator Injection â€º should block combined stream redirection (2>&1)

    expect(received).toThrow(expected)

    Expected pattern: /blocked operator.*2>&1/
    Received message: "Command contains blocked operator: '&'Â·
    WHY: Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.Â·
    TO FIX:
    1. Create a config file at one of these locations:
       - config.json (in current working directory)
       - ~/.win-cli-mcp/config.json (in home directory)
    2. Remove '&' from the \"shells.{shellName}.blockedOperators\" array
    3. Restart the MCP serverÂ·
    WARNING: Allowing '&' enables command chaining and could allow malicious code execution. Only allow if you trust all command sources.Â·
    TIP: Use the check_security_config tool to view all blocked operators for each shell."

        [0m [90m 376 |[39m         [36mif[39m (normalizedCommand[33m.[39mincludes(op)) {
         [90m 377 |[39m             [36mconst[39m configLocationMsg [33m=[39m getConfigLocationMessage(configPath)[33m;[39m
        [31m[1m>[22m[39m[90m 378 |[39m             [36mthrow[39m [36mnew[39m [33mError[39m(formatEnhancedError({
         [90m     |[39m                   [31m[1m^[22m[39m
         [90m 379 |[39m                 what[33m:[39m [32m`Command contains blocked operator: '${op}'`[39m[33m,[39m
         [90m 380 |[39m                 why[33m:[39m [32m'Shell operators like |, &, ;, >, < can be used to chain commands, redirect output, or execute multiple commands. This is blocked to prevent command injection attacks.'[39m[33m,[39m
         [90m 381 |[39m                 howToFix[33m:[39m [[0m

      at validateShellOperators (src/utils/validation.ts:378:19)
      at __tests__/security/command-injection.test.ts:98:20
      at Object.<anonymous> (node_modules/expect/build/toThrowMatchers.js:74:11)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:320:21)
      at Object.<anonymous> (__tests__/security/command-injection.test.ts:99:10)
      at Object.<anonymous> (__tests__/security/command-injection.test.ts:99:10)

  â— Command Injection Attack Vectors â€º Command Parsing Edge Cases â€º should handle tabs as whitespace

    expect(received).toBe(expected) // Object.is equality

    Expected: "echo"
    Received: "echo	test"

    [0m [90m 386 |[39m     test([32m'should handle tabs as whitespace'[39m[33m,[39m () [33m=>[39m {
     [90m 387 |[39m       [36mconst[39m { command[33m,[39m args } [33m=[39m parseCommand([32m'echo\ttest'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 388 |[39m       expect(command)[33m.[39mtoBe([32m'echo'[39m)[33m;[39m
     [90m     |[39m                       [31m[1m^[22m[39m
     [90m 389 |[39m       expect(args)[33m.[39mtoEqual([[32m'test'[39m])[33m;[39m
     [90m 390 |[39m     })[33m;[39m
     [90m 391 |[39m[0m

      at Object.<anonymous> (__tests__/security/command-injection.test.ts:388:23)

FAIL __tests__/security/ssh-security.test.ts (8.012 s)
  â— Console

    console.error
      WARNING: Adding new host example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:68:22)

    console.error
      Host key fingerprint: SHA256:Z28g5+7ylMlPREyL/jM8Cx27G0al0zgI1hSzFvr14Y0=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:68:22)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:68:22)

    console.error
      WARNING: Adding new host test.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:84:7)

    console.error
      Host key fingerprint: SHA256:LCk83ZbZWKLDjR+7ZU+Wo0h5AZIlGqFDpno2R+PTg1w=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:84:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:84:7)

    console.error
      WARNING: Adding new host timestamped.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:97:7)

    console.error
      Host key fingerprint: SHA256:Ej8sQzSprfrALyfh3cU5uRxyC+w04TtjIIKyJN55eP4=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:97:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:97:7)

    console.error
      WARNING: Adding new host persist.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:112:7)

    console.error
      Host key fingerprint: SHA256:lPyIeCW+p6CWWagSNV7jKNTsVCW0M3mtvA+bJ8s2Svc=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:112:7)

    console.error
      Algorithm: ssh-rsa

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:112:7)

    console.error
      WARNING: Adding new host repeat.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:126:7)

    console.error
      Host key fingerprint: SHA256:UdopZw6gI3d4PRwQv9XgLIDgXJGGyd/h4RUBGxgzD0U=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:126:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:126:7)

    console.error
      WARNING: Adding new host timestamp-update.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:139:7)

    console.error
      Host key fingerprint: SHA256:J5rbXzEwTwMyN1Dc1dcJ3HA5mPmgMo42YY6lnPRiz/A=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:139:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:139:7)

    console.error
      SECURITY WARNING: Unknown host unknown.example.com:22

    [0m [90m 130 |[39m       [36mif[39m (strictMode) {
     [90m 131 |[39m         [90m// Strict mode: reject unknown hosts[39m
    [31m[1m>[22m[39m[90m 132 |[39m         console[33m.[39merror([32m`SECURITY WARNING: Unknown host ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 133 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 134 |[39m         console[33m.[39merror([32m'Strict host key checking is enabled. Connection rejected.'[39m)[33m;[39m
     [90m 135 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:132:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:160:22)

    console.error
      Host key fingerprint: SHA256:eBCOcAAx4x/ivzlX/OzK+W7WbU4amvZiBaHCiZZEOpA=

    [0m [90m 131 |[39m         [90m// Strict mode: reject unknown hosts[39m
     [90m 132 |[39m         console[33m.[39merror([32m`SECURITY WARNING: Unknown host ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 133 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 134 |[39m         console[33m.[39merror([32m'Strict host key checking is enabled. Connection rejected.'[39m)[33m;[39m
     [90m 135 |[39m         [36mreturn[39m {
     [90m 136 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:133:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:160:22)

    console.error
      Strict host key checking is enabled. Connection rejected.

    [0m [90m 132 |[39m         console[33m.[39merror([32m`SECURITY WARNING: Unknown host ${host}:${port}`[39m)[33m;[39m
     [90m 133 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 134 |[39m         console[33m.[39merror([32m'Strict host key checking is enabled. Connection rejected.'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 135 |[39m         [36mreturn[39m {
     [90m 136 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m
     [90m 137 |[39m           reason[33m:[39m [32m`Unknown host ${host}:${port}. Enable TOFU mode (strictHostKeyChecking: false) to accept on first connection.`[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:134:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:160:22)

    console.error
      SECURITY WARNING: Unknown host rejected.example.com:22

    [0m [90m 130 |[39m       [36mif[39m (strictMode) {
     [90m 131 |[39m         [90m// Strict mode: reject unknown hosts[39m
    [31m[1m>[22m[39m[90m 132 |[39m         console[33m.[39merror([32m`SECURITY WARNING: Unknown host ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 133 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 134 |[39m         console[33m.[39merror([32m'Strict host key checking is enabled. Connection rejected.'[39m)[33m;[39m
     [90m 135 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:132:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:176:7)

    console.error
      Host key fingerprint: SHA256:yU287QMlw2KOBh0VEPz6y9hBWuz1e8ac7PP5w+Gi6vY=

    [0m [90m 131 |[39m         [90m// Strict mode: reject unknown hosts[39m
     [90m 132 |[39m         console[33m.[39merror([32m`SECURITY WARNING: Unknown host ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 133 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 134 |[39m         console[33m.[39merror([32m'Strict host key checking is enabled. Connection rejected.'[39m)[33m;[39m
     [90m 135 |[39m         [36mreturn[39m {
     [90m 136 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:133:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:176:7)

    console.error
      Strict host key checking is enabled. Connection rejected.

    [0m [90m 132 |[39m         console[33m.[39merror([32m`SECURITY WARNING: Unknown host ${host}:${port}`[39m)[33m;[39m
     [90m 133 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 134 |[39m         console[33m.[39merror([32m'Strict host key checking is enabled. Connection rejected.'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 135 |[39m         [36mreturn[39m {
     [90m 136 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m
     [90m 137 |[39m           reason[33m:[39m [32m`Unknown host ${host}:${port}. Enable TOFU mode (strictHostKeyChecking: false) to accept on first connection.`[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:134:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:176:7)

    console.error
      WARNING: Adding new host known.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:187:7)

    console.error
      Host key fingerprint: SHA256:jFqe2rU7MCZR3M8JUGi65qZ6QhpOyepFc4iepGPyTg8=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:187:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:187:7)

    console.error
      SECURITY WARNING: Unknown host suggest.example.com:22

    [0m [90m 130 |[39m       [36mif[39m (strictMode) {
     [90m 131 |[39m         [90m// Strict mode: reject unknown hosts[39m
    [31m[1m>[22m[39m[90m 132 |[39m         console[33m.[39merror([32m`SECURITY WARNING: Unknown host ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 133 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 134 |[39m         console[33m.[39merror([32m'Strict host key checking is enabled. Connection rejected.'[39m)[33m;[39m
     [90m 135 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:132:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:199:22)

    console.error
      Host key fingerprint: SHA256:2h4HX3ctP3bqIFKHK3wpLvub5u1Ku5VpaEw0ShWXrH0=

    [0m [90m 131 |[39m         [90m// Strict mode: reject unknown hosts[39m
     [90m 132 |[39m         console[33m.[39merror([32m`SECURITY WARNING: Unknown host ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 133 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 134 |[39m         console[33m.[39merror([32m'Strict host key checking is enabled. Connection rejected.'[39m)[33m;[39m
     [90m 135 |[39m         [36mreturn[39m {
     [90m 136 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:133:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:199:22)

    console.error
      Strict host key checking is enabled. Connection rejected.

    [0m [90m 132 |[39m         console[33m.[39merror([32m`SECURITY WARNING: Unknown host ${host}:${port}`[39m)[33m;[39m
     [90m 133 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 134 |[39m         console[33m.[39merror([32m'Strict host key checking is enabled. Connection rejected.'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 135 |[39m         [36mreturn[39m {
     [90m 136 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m
     [90m 137 |[39m           reason[33m:[39m [32m`Unknown host ${host}:${port}. Enable TOFU mode (strictHostKeyChecking: false) to accept on first connection.`[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:134:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:199:22)

    console.error
      WARNING: Adding new host mitm.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:213:7)

    console.error
      Host key fingerprint: SHA256:x2L+wLCsu5qd5Z616q/I4dgfee4OujXLsoYU+Fjb780=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:213:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:213:7)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 175 |[39m       } [36melse[39m {
     [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
    [31m[1m>[22m[39m[90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:177:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
      !!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!

    [0m [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
     [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:178:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:179:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
      Host: mitm.example.com:22

    [0m [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:180:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
      Expected fingerprint: SHA256:x2L+wLCsu5qd5Z616q/I4dgfee4OujXLsoYU+Fjb780=

    [0m [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:181:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
      Received fingerprint: SHA256:czUNDmfOmiH2V9jm3241KUUCgYfEawY66RircrQ9xNE=

    [0m [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:182:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
      Expected algorithm: ssh-ed25519

    [0m [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:183:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
      Received algorithm: ssh-ed25519

    [0m [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:184:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error


    [0m [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:185:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
      This could indicate:

    [0m [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:186:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
        1. A Man-in-the-Middle (MITM) attack in progress

    [0m [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:187:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
        2. The host key has been legitimately changed

    [0m [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:188:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
        3. DNS spoofing or IP address reassignment

    [0m [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:189:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error


    [0m [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:190:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
      If you trust this new key, manually remove the old entry from:

    [0m [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:191:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
        C:\Users\rbsmi\AppData\Local\Temp\ssh-test-dkJli2\known_hosts.json

    [0m [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:192:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {
     [90m 196 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:193:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:216:22)

    console.error
      WARNING: Adding new host fingerprint-check.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:227:7)

    console.error
      Host key fingerprint: SHA256:at40ZWLC/aO0iK3783l7MUz8VBpUjputkbR7JfSLY0Q=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:227:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:227:7)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 175 |[39m       } [36melse[39m {
     [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
    [31m[1m>[22m[39m[90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:177:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
      !!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!

    [0m [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
     [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:178:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:179:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
      Host: fingerprint-check.example.com:22

    [0m [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:180:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
      Expected fingerprint: SHA256:at40ZWLC/aO0iK3783l7MUz8VBpUjputkbR7JfSLY0Q=

    [0m [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:181:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
      Received fingerprint: SHA256:5h/EXKHYf5/UDcR7whfEhzd96x4KLrcAAZKONcO6bbs=

    [0m [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:182:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
      Expected algorithm: ssh-ed25519

    [0m [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:183:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
      Received algorithm: ssh-ed25519

    [0m [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:184:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error


    [0m [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:185:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
      This could indicate:

    [0m [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:186:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
        1. A Man-in-the-Middle (MITM) attack in progress

    [0m [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:187:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
        2. The host key has been legitimately changed

    [0m [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:188:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
        3. DNS spoofing or IP address reassignment

    [0m [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:189:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error


    [0m [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:190:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
      If you trust this new key, manually remove the old entry from:

    [0m [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:191:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
        C:\Users\rbsmi\AppData\Local\Temp\ssh-test-0j2Kvj\known_hosts.json

    [0m [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:192:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {
     [90m 196 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:193:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:228:22)

    console.error
      WARNING: Adding new host algo-change.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:240:7)

    console.error
      Host key fingerprint: SHA256:MlkJ03mgR+6tqwoaYQFj+kU4RN6jFMHGsW3LQtRTxSk=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:240:7)

    console.error
      Algorithm: ssh-rsa

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:240:7)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 175 |[39m       } [36melse[39m {
     [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
    [31m[1m>[22m[39m[90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:177:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
      !!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!

    [0m [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
     [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:178:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:179:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
      Host: algo-change.example.com:22

    [0m [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:180:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
      Expected fingerprint: SHA256:MlkJ03mgR+6tqwoaYQFj+kU4RN6jFMHGsW3LQtRTxSk=

    [0m [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:181:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
      Received fingerprint: SHA256:6+uU93RrEyWNDMod68BmdQvMFvbCKQRe391ATT2HZyU=

    [0m [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:182:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
      Expected algorithm: ssh-rsa

    [0m [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:183:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
      Received algorithm: ssh-ed25519

    [0m [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:184:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error


    [0m [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:185:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
      This could indicate:

    [0m [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:186:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
        1. A Man-in-the-Middle (MITM) attack in progress

    [0m [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:187:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
        2. The host key has been legitimately changed

    [0m [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:188:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
        3. DNS spoofing or IP address reassignment

    [0m [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:189:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error


    [0m [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:190:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
      If you trust this new key, manually remove the old entry from:

    [0m [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:191:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
        C:\Users\rbsmi\AppData\Local\Temp\ssh-test-tRykmV\known_hosts.json

    [0m [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:192:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {
     [90m 196 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:193:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:241:22)

    console.error
      WARNING: Adding new host no-update.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:251:7)

    console.error
      Host key fingerprint: SHA256:E27A4M7uRw9Cdpp81vwaDAuiXrMtGYOIPP/bk8wg/48=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:251:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:251:7)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 175 |[39m       } [36melse[39m {
     [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
    [31m[1m>[22m[39m[90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:177:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
      !!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!

    [0m [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
     [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:178:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:179:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
      Host: no-update.example.com:22

    [0m [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:180:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
      Expected fingerprint: SHA256:E27A4M7uRw9Cdpp81vwaDAuiXrMtGYOIPP/bk8wg/48=

    [0m [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:181:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
      Received fingerprint: SHA256:WrYiykEfmxDwwXWvaJ7VhL/Rrno89Jy/TDKqLwA9WAE=

    [0m [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:182:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
      Expected algorithm: ssh-ed25519

    [0m [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:183:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
      Received algorithm: ssh-ed25519

    [0m [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:184:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error


    [0m [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:185:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
      This could indicate:

    [0m [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:186:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
        1. A Man-in-the-Middle (MITM) attack in progress

    [0m [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:187:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
        2. The host key has been legitimately changed

    [0m [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:188:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
        3. DNS spoofing or IP address reassignment

    [0m [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:189:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error


    [0m [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:190:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
      If you trust this new key, manually remove the old entry from:

    [0m [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:191:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
        C:\Users\rbsmi\AppData\Local\Temp\ssh-test-0XIEFE\known_hosts.json

    [0m [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:192:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {
     [90m 196 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:193:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:255:7)

    console.error
      WARNING: Adding new host legit-change.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:267:7)

    console.error
      Host key fingerprint: SHA256:4plCkHJ7gYK0cw7RZe4r+nhvl8bcIgXHe3ImF9ZbNXM=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:267:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:267:7)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 175 |[39m       } [36melse[39m {
     [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
    [31m[1m>[22m[39m[90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:177:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
      !!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!

    [0m [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
     [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:178:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:179:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
      Host: legit-change.example.com:22

    [0m [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:180:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
      Expected fingerprint: SHA256:4plCkHJ7gYK0cw7RZe4r+nhvl8bcIgXHe3ImF9ZbNXM=

    [0m [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:181:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
      Received fingerprint: SHA256:oI50RV7YhGXUWChAssMQxfU7L2f5INObfxKTAHuqeJY=

    [0m [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:182:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
      Expected algorithm: ssh-ed25519

    [0m [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:183:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
      Received algorithm: ssh-ed25519

    [0m [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:184:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error


    [0m [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:185:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
      This could indicate:

    [0m [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:186:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
        1. A Man-in-the-Middle (MITM) attack in progress

    [0m [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:187:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
        2. The host key has been legitimately changed

    [0m [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:188:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
        3. DNS spoofing or IP address reassignment

    [0m [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:189:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error


    [0m [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:190:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
      If you trust this new key, manually remove the old entry from:

    [0m [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:191:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
        C:\Users\rbsmi\AppData\Local\Temp\ssh-test-JVRrrE\known_hosts.json

    [0m [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:192:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {
     [90m 196 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:193:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:268:22)

    console.error
      WARNING: Adding new host multi-port.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:281:7)

    console.error
      Host key fingerprint: SHA256:9EikdKG3htSP8QpZfF9lFVNjwuEx7g2eyJkkG/2jOyQ=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:281:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:281:7)

    console.error
      WARNING: Adding new host multi-port.example.com:2222 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:282:7)

    console.error
      Host key fingerprint: SHA256:c0kNCiNSHMCuxoelpzf7wpkA5dsut3/672Gr5cXnFOI=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:282:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:282:7)

    console.error
      WARNING: Adding new host host1.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:296:7)

    console.error
      Host key fingerprint: SHA256:obMz9mzHz0JZPZ7SS1ydaGIhTF8IrpdJl0TjN52GY64=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:296:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:296:7)

    console.error
      WARNING: Adding new host host2.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:297:7)

    console.error
      Host key fingerprint: SHA256:HbD12nAMGZ4+0NViKiUMvsmkkDxHVlqL7raKI2BTS4A=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:297:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:297:7)

    console.error
      WARNING: Adding new host example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:309:7)

    console.error
      Host key fingerprint: SHA256:MuBTU+UC6EnljLyQhhZuGWtafk0g+la3rN84B70Z7tY=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:309:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:309:7)

    console.error
      WARNING: Adding new host 192.168.1.1:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:310:7)

    console.error
      Host key fingerprint: SHA256:wXKwz1Dn4nlzv/5m4kG3VBDTekCwRT5OE02m1Z9xyK4=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:310:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:310:7)

    console.error
      WARNING: Adding new host fingerprint.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:325:7)

    console.error
      Host key fingerprint: SHA256:fFyiCOElAvTTLbvdqvKYMcpEPX/HlHCcRUfgEmEumZ8=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:325:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:325:7)

    console.error
      WARNING: Adding new host fp1.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:335:7)

    console.error
      Host key fingerprint: SHA256:CApvzKbPWGXotfPhS+JopMPA5JOKzfdzQS7fEJ00aiY=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:335:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:335:7)

    console.error
      WARNING: Adding new host fp2.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:336:7)

    console.error
      Host key fingerprint: SHA256:xcFxSc1MzX7DCVMUWkZgXokpliu0WdnbRhObooPO+30=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:336:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:336:7)

    console.error
      WARNING: Adding new host same-fp1.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:349:7)

    console.error
      Host key fingerprint: SHA256:XVWSQljJAFABR7q8JbTiGwOIEfYke3T6qSAqyTIQV/c=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:349:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:349:7)

    console.error
      WARNING: Adding new host same-fp2.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:350:7)

    console.error
      Host key fingerprint: SHA256:XVWSQljJAFABR7q8JbTiGwOIEfYke3T6qSAqyTIQV/c=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:350:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:350:7)

    console.error
      WARNING: Adding new host rsa.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:363:7)

    console.error
      Host key fingerprint: SHA256:UNVdV+tyBzHI37lZqg1mD7mUBw0X1/KBA1vek6KUQ0I=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:363:7)

    console.error
      Algorithm: ssh-rsa

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:363:7)

    console.error
      WARNING: Adding new host ed25519.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:372:7)

    console.error
      Host key fingerprint: SHA256:TSB95X5yzNkqcPBqAy9vjH3EJP9mkwXns5mZV3bW76Y=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:372:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:372:7)

    console.error
      WARNING: Adding new host ecdsa.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:381:7)

    console.error
      Host key fingerprint: SHA256:mRZBJcNBR3gkzaUbv+v0lS6AJbs7VD2EREHsYVULEk4=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:381:7)

    console.error
      Algorithm: ecdsa-sha2-nistp256

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:381:7)

    console.error
      WARNING: Adding new host malformed.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:390:22)

    console.error
      Host key fingerprint: SHA256:IQv+MISyUFJtSnCbVoBs/368bpsWTEWfiPCe6zryDxg=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:390:22)

    console.error
      Algorithm: lid key data

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:390:22)

    console.error
      WARNING: Adding new host concurrent0.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
          at async Promise.all (index 0)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Host key fingerprint: SHA256:K/TpZsoXtl+uNlrbOCL9YZLeNju/14KVIdsaeQ4QrQk=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
          at async Promise.all (index 0)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
          at async Promise.all (index 0)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      WARNING: Adding new host concurrent1.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
          at async Promise.all (index 1)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Host key fingerprint: SHA256:8bxUMM03OMTs73r7xxfE/onyxMmLfCziVEaIar8XtXk=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
          at async Promise.all (index 1)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
          at async Promise.all (index 1)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      WARNING: Adding new host concurrent2.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
          at async Promise.all (index 2)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Host key fingerprint: SHA256:3KSXk/J3WPqnxgtniN4BtQM7DQQfmQEtB5Jv5FMr0IA=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
          at async Promise.all (index 2)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
          at async Promise.all (index 2)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      WARNING: Adding new host concurrent3.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
          at async Promise.all (index 3)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Host key fingerprint: SHA256:Yppd3YAVxPmkNVXub7VUhQTV46jnI1uykWETVEzUtIE=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
          at async Promise.all (index 3)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
          at async Promise.all (index 3)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      WARNING: Adding new host concurrent4.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
          at async Promise.all (index 4)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Host key fingerprint: SHA256:gXWUf9VVCWiCexmtpm3TOXF7BsXg6qMvJk+GeWjdDqM=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
          at async Promise.all (index 4)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
          at async Promise.all (index 4)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      WARNING: Adding new host concurrent5.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
          at async Promise.all (index 5)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Host key fingerprint: SHA256:iWSNJtfO5uaaVS9QT5JHkRHD7+R/SX/RUzjAb+3Htaw=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
          at async Promise.all (index 5)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
          at async Promise.all (index 5)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      WARNING: Adding new host concurrent6.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
          at async Promise.all (index 6)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Host key fingerprint: SHA256:hDRWr2N2BGIxKR5UOrlf35N0IKJnusMzzjOxGMCaOow=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
          at async Promise.all (index 6)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
          at async Promise.all (index 6)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      WARNING: Adding new host concurrent7.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
          at async Promise.all (index 7)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Host key fingerprint: SHA256:q6CIXwRNHRD01ZevO6oVuSgkoYQL0wbYFTZZ0NW2Jt0=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
          at async Promise.all (index 7)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
          at async Promise.all (index 7)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      WARNING: Adding new host concurrent8.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
          at async Promise.all (index 8)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Host key fingerprint: SHA256:ygE2L0vH9nfkJUErvktw5GoZ7ATw+VVHEOU7MFxnXME=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
          at async Promise.all (index 8)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
          at async Promise.all (index 8)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      WARNING: Adding new host concurrent9.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
          at async Promise.all (index 9)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Host key fingerprint: SHA256:fXSclyzQ/SQXmcWnyTyCCTxA6K7DW4eIl1M46F2r49A=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
          at async Promise.all (index 9)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
          at async Promise.all (index 9)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Failed to update known hosts: Lock file is already being held

    [0m [90m 257 |[39m       }
     [90m 258 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 259 |[39m       console[33m.[39merror([32m'Failed to update known hosts:'[39m[33m,[39m error [36minstanceof[39m [33mError[39m [33m?[39m error[33m.[39mmessage [33m:[39m [33mString[39m(error))[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 260 |[39m       [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to save SSH host key'[39m)[33m;[39m
     [90m 261 |[39m     }
     [90m 262 |[39m   }[0m

      at KnownHostsManager.addOrUpdateHost (src/utils/knownHosts.ts:259:15)
      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:154:9)
          at async Promise.all (index 8)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

    console.error
      Failed to update known hosts: Lock file is already being held

    [0m [90m 257 |[39m       }
     [90m 258 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 259 |[39m       console[33m.[39merror([32m'Failed to update known hosts:'[39m[33m,[39m error [36minstanceof[39m [33mError[39m [33m?[39m error[33m.[39mmessage [33m:[39m [33mString[39m(error))[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 260 |[39m       [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to save SSH host key'[39m)[33m;[39m
     [90m 261 |[39m     }
     [90m 262 |[39m   }[0m

      at KnownHostsManager.addOrUpdateHost (src/utils/knownHosts.ts:259:15)
      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:154:9)
          at async Promise.all (index 3)

    console.error
      Failed to update known hosts: Lock file is already being held

    [0m [90m 257 |[39m       }
     [90m 258 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 259 |[39m       console[33m.[39merror([32m'Failed to update known hosts:'[39m[33m,[39m error [36minstanceof[39m [33mError[39m [33m?[39m error[33m.[39mmessage [33m:[39m [33mString[39m(error))[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 260 |[39m       [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to save SSH host key'[39m)[33m;[39m
     [90m 261 |[39m     }
     [90m 262 |[39m   }[0m

      at KnownHostsManager.addOrUpdateHost (src/utils/knownHosts.ts:259:15)
      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:154:9)
          at async Promise.all (index 7)

    console.error
      Failed to update known hosts: Lock file is already being held

    [0m [90m 257 |[39m       }
     [90m 258 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 259 |[39m       console[33m.[39merror([32m'Failed to update known hosts:'[39m[33m,[39m error [36minstanceof[39m [33mError[39m [33m?[39m error[33m.[39mmessage [33m:[39m [33mString[39m(error))[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 260 |[39m       [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to save SSH host key'[39m)[33m;[39m
     [90m 261 |[39m     }
     [90m 262 |[39m   }[0m

      at KnownHostsManager.addOrUpdateHost (src/utils/knownHosts.ts:259:15)
      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:154:9)
          at async Promise.all (index 6)

    console.error
      WARNING: Adding new host concurrent-same.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:426:7)

    console.error
      Host key fingerprint: SHA256:REci9DWTdgjPB3rbPmqG0G+6V9C8s8D/75nPFiaq2lY=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:426:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:426:7)

    console.error
      Failed to update known hosts: Lock file is already being held

    [0m [90m 257 |[39m       }
     [90m 258 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 259 |[39m       console[33m.[39merror([32m'Failed to update known hosts:'[39m[33m,[39m error [36minstanceof[39m [33mError[39m [33m?[39m error[33m.[39mmessage [33m:[39m [33mString[39m(error))[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 260 |[39m       [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to save SSH host key'[39m)[33m;[39m
     [90m 261 |[39m     }
     [90m 262 |[39m   }[0m

      at KnownHostsManager.addOrUpdateHost (src/utils/knownHosts.ts:259:15)
      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:169:9)
          at async Promise.all (index 6)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:433:23)

    console.error
      Failed to update known hosts: Lock file is already being held

    [0m [90m 257 |[39m       }
     [90m 258 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 259 |[39m       console[33m.[39merror([32m'Failed to update known hosts:'[39m[33m,[39m error [36minstanceof[39m [33mError[39m [33m?[39m error[33m.[39mmessage [33m:[39m [33mString[39m(error))[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 260 |[39m       [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to save SSH host key'[39m)[33m;[39m
     [90m 261 |[39m     }
     [90m 262 |[39m   }[0m

      at KnownHostsManager.addOrUpdateHost (src/utils/knownHosts.ts:259:15)
      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:169:9)
          at async Promise.all (index 4)

    console.error
      Failed to update known hosts: Lock file is already being held

    [0m [90m 257 |[39m       }
     [90m 258 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 259 |[39m       console[33m.[39merror([32m'Failed to update known hosts:'[39m[33m,[39m error [36minstanceof[39m [33mError[39m [33m?[39m error[33m.[39mmessage [33m:[39m [33mString[39m(error))[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 260 |[39m       [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to save SSH host key'[39m)[33m;[39m
     [90m 261 |[39m     }
     [90m 262 |[39m   }[0m

      at KnownHostsManager.addOrUpdateHost (src/utils/knownHosts.ts:259:15)
      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:169:9)
          at async Promise.all (index 9)

    console.error
      Failed to update known hosts: Lock file is already being held

    [0m [90m 257 |[39m       }
     [90m 258 |[39m     } [36mcatch[39m (error) {
    [31m[1m>[22m[39m[90m 259 |[39m       console[33m.[39merror([32m'Failed to update known hosts:'[39m[33m,[39m error [36minstanceof[39m [33mError[39m [33m?[39m error[33m.[39mmessage [33m:[39m [33mString[39m(error))[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 260 |[39m       [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to save SSH host key'[39m)[33m;[39m
     [90m 261 |[39m     }
     [90m 262 |[39m   }[0m

      at KnownHostsManager.addOrUpdateHost (src/utils/knownHosts.ts:259:15)
      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:169:9)
          at async Promise.all (index 8)

    console.error
      WARNING: Adding new host persist-reload.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:451:7)

    console.error
      Host key fingerprint: SHA256:Sd8vY8UPDUPW/L2fSnKAP1Iy7agKuppYuRUAyKkpRis=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:451:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:451:7)

    console.error
      WARNING: Adding new host reload-security.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:468:7)

    console.error
      Host key fingerprint: SHA256:F8VOi05Ysy6WywpCMBQZ8+ZPmRCImxuyCctqq6rgXdY=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:468:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:468:7)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 175 |[39m       } [36melse[39m {
     [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
    [31m[1m>[22m[39m[90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:177:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
      !!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!

    [0m [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
     [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:178:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:179:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
      Host: reload-security.example.com:22

    [0m [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:180:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
      Expected fingerprint: SHA256:F8VOi05Ysy6WywpCMBQZ8+ZPmRCImxuyCctqq6rgXdY=

    [0m [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:181:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
      Received fingerprint: SHA256:sWDlTqEnUD6DxcoJjPwYzvtnHe+AL0M25GDad0Kqdw0=

    [0m [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:182:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
      Expected algorithm: ssh-ed25519

    [0m [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:183:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
      Received algorithm: ssh-ed25519

    [0m [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:184:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error


    [0m [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:185:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
      This could indicate:

    [0m [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:186:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
        1. A Man-in-the-Middle (MITM) attack in progress

    [0m [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:187:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
        2. The host key has been legitimately changed

    [0m [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:188:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
        3. DNS spoofing or IP address reassignment

    [0m [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:189:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error


    [0m [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:190:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
      If you trust this new key, manually remove the old entry from:

    [0m [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:191:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
        C:\Users\rbsmi\AppData\Local\Temp\ssh-test-JpbS9K\known_hosts.json

    [0m [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:192:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {
     [90m 196 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:193:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:473:22)

    console.error
      WARNING: Adding new host remove-me.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:485:7)

    console.error
      Host key fingerprint: SHA256:ii30eaPnv17xDBdQdDpeoA3raODuh3LmIEHYNEhpjuA=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:485:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:485:7)

    console.error
      WARNING: Adding new host readd.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:497:7)

    console.error
      Host key fingerprint: SHA256:B7Z8F8q6Zf5DZHFC/pth7kDhf99xTU4gpV7LxmXF5LE=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:497:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:497:7)

    console.error
      WARNING: Adding new host readd.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:503:22)

    console.error
      Host key fingerprint: SHA256:py8SyBEVE+S8INHbExk9nmd+jVR2XBKU/d/7ZSHNO2E=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:503:22)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:503:22)

    console.error
      WARNING: Adding new host keep.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:514:7)

    console.error
      Host key fingerprint: SHA256:E6XqKk0B2XjOh2yXzIT2WU7huR3jmGI4Go0zNlgYt/k=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:514:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:514:7)

    console.error
      WARNING: Adding new host remove.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:515:7)

    console.error
      Host key fingerprint: SHA256:RYKaSV+Da6XqVzRKMlWcTw3vXx5/V33zC8uwT+/xq5A=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:515:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:515:7)

    console.error
      WARNING: Adding new host host1.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:534:9)

    console.error
      Host key fingerprint: SHA256:Stisj9klbNrezpBCc3ucH6sjPQp1EdQ53G+xTblbEVM=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:534:9)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:534:9)

    console.error
      WARNING: Adding new host host2.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:534:9)

    console.error
      Host key fingerprint: SHA256:DHwW4SuQqm5OgI+PYPINqnla/SEWPSQW4EoO5CXXZA0=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:534:9)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:534:9)

    console.error
      WARNING: Adding new host host3.example.com:2222 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:534:9)

    console.error
      Host key fingerprint: SHA256:3NKd5SulWJznZ4Oc8d2EARD5sYtRU3nLP4hN4azZHeE=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:534:9)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:534:9)

    console.error
      Failed to parse key algorithm: RangeError [ERR_BUFFER_OUT_OF_BOUNDS]: Attempt to access memory outside buffer bounds

    [0m [90m 121 |[39m       algorithm [33m=[39m key[33m.[39mtoString([32m'utf8'[39m[33m,[39m [35m4[39m[33m,[39m [35m4[39m [33m+[39m algLength)[33m;[39m
     [90m 122 |[39m     } [36mcatch[39m (err) {
    [31m[1m>[22m[39m[90m 123 |[39m       console[33m.[39merror([32m'Failed to parse key algorithm:'[39m[33m,[39m err [36minstanceof[39m [33mError[39m [33m?[39m err[33m.[39mmessage [33m:[39m [33mString[39m(err))[33m;[39m
     [90m     |[39m               [31m[1m^[22m[39m
     [90m 124 |[39m     }
     [90m 125 |[39m
     [90m 126 |[39m     [36mconst[39m existingEntry [33m=[39m [36mthis[39m[33m.[39mknownHosts[hostKey][33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:123:15)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:555:22)

    console.error
      WARNING: Adding new host empty-key.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:555:22)

    console.error
      Host key fingerprint: SHA256:47DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:555:22)

    console.error
      Algorithm: unknown

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:555:22)

    console.error
      WARNING: Adding new host aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:566:22)

    console.error
      Host key fingerprint: SHA256:w0Im8KpuX2FzB7hvCkBb0cwiR+zJZc4cDPUgwc0CVEM=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:566:22)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:566:22)

    console.error
      WARNING: Adding new host custom-port.example.com:65535 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:574:22)

    console.error
      Host key fingerprint: SHA256:7mG9uDkx1RnKnZSlO9RGr+LrFSgD8L5CvOviu9jqpGE=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:574:22)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:574:22)

    console.error
      WARNING: Adding new host test-host_123.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:585:22)

    console.error
      Host key fingerprint: SHA256:EsdMtRx9zeD51bFcmd2SDVbSg+7mHnokNuqvTL8BGnY=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:585:22)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:585:22)

    console.error
      WARNING: Adding new host bank.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:602:31)

    console.error
      Host key fingerprint: SHA256:5hMabNVBTa9pAeHYdwFsrQy4hakDQYklicaB63y9nP0=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:602:31)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:602:31)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 175 |[39m       } [36melse[39m {
     [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
    [31m[1m>[22m[39m[90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:177:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
      !!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!

    [0m [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
     [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:178:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:179:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
      Host: bank.example.com:22

    [0m [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:180:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
      Expected fingerprint: SHA256:5hMabNVBTa9pAeHYdwFsrQy4hakDQYklicaB63y9nP0=

    [0m [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:181:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
      Received fingerprint: SHA256:d+rUWKWjnBD9mzNAf5P8Z6SXpcNJD9Dx+vB8JVr4888=

    [0m [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:182:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
      Expected algorithm: ssh-ed25519

    [0m [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:183:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
      Received algorithm: ssh-ed25519

    [0m [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:184:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error


    [0m [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:185:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
      This could indicate:

    [0m [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:186:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
        1. A Man-in-the-Middle (MITM) attack in progress

    [0m [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:187:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
        2. The host key has been legitimately changed

    [0m [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:188:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
        3. DNS spoofing or IP address reassignment

    [0m [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:189:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error


    [0m [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:190:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
      If you trust this new key, manually remove the old entry from:

    [0m [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:191:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
        C:\Users\rbsmi\AppData\Local\Temp\ssh-test-vXs3oC\known_hosts.json

    [0m [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:192:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {
     [90m 196 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:193:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:606:20)

    console.error
      WARNING: Adding new host server.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:619:7)

    console.error
      Host key fingerprint: SHA256:1/UN2f1wACGSgvIhJNyTtJqlh/TwYF3rmAgEeUWqu+g=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:619:7)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:619:7)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 175 |[39m       } [36melse[39m {
     [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
    [31m[1m>[22m[39m[90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:177:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
      !!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!

    [0m [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
     [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:178:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:179:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
      Host: server.example.com:22

    [0m [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:180:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
      Expected fingerprint: SHA256:1/UN2f1wACGSgvIhJNyTtJqlh/TwYF3rmAgEeUWqu+g=

    [0m [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:181:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
      Received fingerprint: SHA256:JNloLDug4uc7YWlOwnIOIFkVQQaICnG3DnX1uZeQ/xs=

    [0m [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:182:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
      Expected algorithm: ssh-ed25519

    [0m [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:183:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
      Received algorithm: ssh-ed25519

    [0m [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:184:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error


    [0m [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:185:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
      This could indicate:

    [0m [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:186:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
        1. A Man-in-the-Middle (MITM) attack in progress

    [0m [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:187:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
        2. The host key has been legitimately changed

    [0m [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:188:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
        3. DNS spoofing or IP address reassignment

    [0m [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:189:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error


    [0m [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:190:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
      If you trust this new key, manually remove the old entry from:

    [0m [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:191:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
        C:\Users\rbsmi\AppData\Local\Temp\ssh-test-ghoEHH\known_hosts.json

    [0m [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:192:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {
     [90m 196 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:193:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:622:23)

    console.error
      WARNING: Adding new host upgraded.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:634:7)

    console.error
      Host key fingerprint: SHA256:9qE2jmHsIvo04hy5hf4l0Lu3tMrz63gSFDMTipSjYnc=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:634:7)

    console.error
      Algorithm: ssh-rsa

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:634:7)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 175 |[39m       } [36melse[39m {
     [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
    [31m[1m>[22m[39m[90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:177:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
      !!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!

    [0m [90m 176 |[39m         [90m// KEY MISMATCH - POSSIBLE MITM ATTACK![39m
     [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:178:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 177 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:179:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
      Host: upgraded.example.com:22

    [0m [90m 178 |[39m         console[33m.[39merror([32m'!!! CRITICAL SECURITY ALERT: SSH HOST KEY MISMATCH !!!'[39m)[33m;[39m
     [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:180:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
      Expected fingerprint: SHA256:9qE2jmHsIvo04hy5hf4l0Lu3tMrz63gSFDMTipSjYnc=

    [0m [90m 179 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:181:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
      Received fingerprint: SHA256:A7H7qrgFTSnnC8eQjNTQ8CwRcd3HybG/01sSSdb+s6M=

    [0m [90m 180 |[39m         console[33m.[39merror([32m`Host: ${host}:${port}`[39m)[33m;[39m
     [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:182:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
      Expected algorithm: ssh-rsa

    [0m [90m 181 |[39m         console[33m.[39merror([32m`Expected fingerprint: ${existingEntry.fingerprint}`[39m)[33m;[39m
     [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:183:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
      Received algorithm: ssh-ed25519

    [0m [90m 182 |[39m         console[33m.[39merror([32m`Received fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:184:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error


    [0m [90m 183 |[39m         console[33m.[39merror([32m`Expected algorithm: ${existingEntry.algorithm}`[39m)[33m;[39m
     [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:185:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
      This could indicate:

    [0m [90m 184 |[39m         console[33m.[39merror([32m`Received algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:186:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
        1. A Man-in-the-Middle (MITM) attack in progress

    [0m [90m 185 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:187:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
        2. The host key has been legitimately changed

    [0m [90m 186 |[39m         console[33m.[39merror([32m'This could indicate:'[39m)[33m;[39m
     [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:188:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
        3. DNS spoofing or IP address reassignment

    [0m [90m 187 |[39m         console[33m.[39merror([32m'  1. A Man-in-the-Middle (MITM) attack in progress'[39m)[33m;[39m
     [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:189:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error


    [0m [90m 188 |[39m         console[33m.[39merror([32m'  2. The host key has been legitimately changed'[39m)[33m;[39m
     [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:190:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
      If you trust this new key, manually remove the old entry from:

    [0m [90m 189 |[39m         console[33m.[39merror([32m'  3. DNS spoofing or IP address reassignment'[39m)[33m;[39m
     [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:191:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
        C:\Users\rbsmi\AppData\Local\Temp\ssh-test-aW1wYe\known_hosts.json

    [0m [90m 190 |[39m         console[33m.[39merror([32m''[39m)[33m;[39m
     [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:192:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

    [0m [90m 191 |[39m         console[33m.[39merror([32m'If you trust this new key, manually remove the old entry from:'[39m)[33m;[39m
     [90m 192 |[39m         console[33m.[39merror([32m`  ${this.knownHostsPath}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 193 |[39m         console[33m.[39merror([32m'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!'[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 194 |[39m
     [90m 195 |[39m         [36mreturn[39m {
     [90m 196 |[39m           accepted[33m:[39m [36mfalse[39m[33m,[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:193:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:637:23)

    console.error
      WARNING: Adding new host upgraded.example.com:22 to known hosts (TOFU mode)

    [0m [90m 139 |[39m       } [36melse[39m {
     [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
    [31m[1m>[22m[39m[90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:141:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:646:24)

    console.error
      Host key fingerprint: SHA256:A7H7qrgFTSnnC8eQjNTQ8CwRcd3HybG/01sSSdb+s6M=

    [0m [90m 140 |[39m         [90m// TOFU mode: accept and store the key[39m
     [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:142:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:646:24)

    console.error
      Algorithm: ssh-ed25519

    [0m [90m 141 |[39m         console[33m.[39merror([32m`WARNING: Adding new host ${host}:${port} to known hosts (TOFU mode)`[39m)[33m;[39m
     [90m 142 |[39m         console[33m.[39merror([32m`Host key fingerprint: ${fingerprint}`[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 143 |[39m         console[33m.[39merror([32m`Algorithm: ${algorithm}`[39m)[33m;[39m
     [90m     |[39m                 [31m[1m^[22m[39m
     [90m 144 |[39m
     [90m 145 |[39m         [36mconst[39m now [33m=[39m [36mnew[39m [33mDate[39m()[33m.[39mtoISOString()[33m;[39m
     [90m 146 |[39m         [36mconst[39m newEntry[33m:[39m [33mHostKeyEntry[39m [33m=[39m {[0m

      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:143:17)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:646:24)

  â— SSH Host Key Verification Security â€º Host Key Change Detection (MITM Protection) â€º should provide guidance on resolving legitimate key changes

    expect(received).toMatch(expected)

    Expected pattern: /manually remove/i
    Received string:  "HOST KEY MISMATCH for legit-change.example.com:22! Possible MITM attack. Expected: SHA256:4plCkHJ7gYK0cw7RZe4r+nhvl8bcIgXHe3ImF9ZbNXM=, Got: SHA256:oI50RV7YhGXUWChAssMQxfU7L2f5INObfxKTAHuqeJY="

    [0m [90m 269 |[39m
     [90m 270 |[39m       expect(result[33m.[39maccepted)[33m.[39mtoBe([36mfalse[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 271 |[39m       expect(result[33m.[39mreason)[33m.[39mtoMatch([35m/manually remove/i[39m)[33m;[39m
     [90m     |[39m                             [31m[1m^[22m[39m
     [90m 272 |[39m       expect(result[33m.[39mreason)[33m.[39mtoMatch([35m/known_hosts/i[39m)[33m;[39m
     [90m 273 |[39m     })[33m;[39m
     [90m 274 |[39m   })[33m;[39m[0m

      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:271:29)

  â— SSH Host Key Verification Security â€º Concurrent Access Safety â€º should handle concurrent verifications safely

    Failed to save SSH host key

    [0m [90m 258 |[39m     } [36mcatch[39m (error) {
     [90m 259 |[39m       console[33m.[39merror([32m'Failed to update known hosts:'[39m[33m,[39m error [36minstanceof[39m [33mError[39m [33m?[39m error[33m.[39mmessage [33m:[39m [33mString[39m(error))[33m;[39m
    [31m[1m>[22m[39m[90m 260 |[39m       [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to save SSH host key'[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 261 |[39m     }
     [90m 262 |[39m   }
     [90m 263 |[39m[0m

      at KnownHostsManager.addOrUpdateHost (src/utils/knownHosts.ts:260:13)
      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:154:9)
          at async Promise.all (index 8)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:408:23)

  â— SSH Host Key Verification Security â€º Concurrent Access Safety â€º should handle concurrent updates to same host safely

    Failed to save SSH host key

    [0m [90m 258 |[39m     } [36mcatch[39m (error) {
     [90m 259 |[39m       console[33m.[39merror([32m'Failed to update known hosts:'[39m[33m,[39m error [36minstanceof[39m [33mError[39m [33m?[39m error[33m.[39mmessage [33m:[39m [33mString[39m(error))[33m;[39m
    [31m[1m>[22m[39m[90m 260 |[39m       [36mthrow[39m [36mnew[39m [33mError[39m([32m'Failed to save SSH host key'[39m)[33m;[39m
     [90m     |[39m             [31m[1m^[22m[39m
     [90m 261 |[39m     }
     [90m 262 |[39m   }
     [90m 263 |[39m[0m

      at KnownHostsManager.addOrUpdateHost (src/utils/knownHosts.ts:260:13)
      at KnownHostsManager.verifyHostKey (src/utils/knownHosts.ts:169:9)
          at async Promise.all (index 6)
      at Object.<anonymous> (__tests__/security/ssh-security.test.ts:433:23)

Test Suites: 5 failed, 1 passed, 6 total
Tests:       27 failed, 325 passed, 352 total
Snapshots:   0 total
Time:        8.964 s, estimated 10 s
Ran all test suites.
